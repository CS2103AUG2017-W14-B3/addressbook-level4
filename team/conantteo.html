<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<title>Conant Teo Jia Yu - Project Portfolio</title>
<link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>Conant Teo Jia Yu - Project Portfolio</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="project-addressbook-level-4"><a class="link" href="#project-addressbook-level-4">Project: AddressBook - Level 4</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>AddressBook - Level 4 is a desktop address book application used for teaching Software Engineering principles. The user interacts with it using a CLI, and it has a GUI created with JavaFX. It is written in Java, and has about 6 kLoC.</p>
</div>
<div class="paragraph">
<p><strong>Code contributed</strong>: to be updated</p>
</div>
<div class="sect2">
<h3 id="enhancement-added-vcard-export"><a class="link" href="#enhancement-added-vcard-export">Enhancement Added: vCard Export</a></h3>
<div class="sect3">
<h4 id="external-behavior"><a class="link" href="#external-behavior">External behavior</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: User Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exporting-contacts-code-export-code"><a class="link" href="#exporting-contacts-code-export-code">Exporting contacts : <code>export</code></a></h3>
<div class="paragraph">
<p>Allows you to export contacts from the application.</p>
</div>
<div class="paragraph">
<p>Format: <code>export all</code> or <code>export INDEX [INDEX]&#8230;&#8203;</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Exports all information of all contacts or at the specified INDEX into a vCard format file.</p>
</li>
<li>
<p>The input 'all' is case-sensitive.</p>
</li>
<li>
<p>The index refers to the index number shown in the most recent listing.</p>
</li>
<li>
<p>The index must be a positive integer 1, 2, 3, &#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>export all</code><br>
Exports all contacts into a vCard format file.</p>
</li>
<li>
<p><code>list</code><br>
<code>export 1 2</code><br>
Exports the 1st and 2nd person from the list of contacts listed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
<div class="sect3">
<h4 id="implementation"><a class="link" href="#implementation">Implementation</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: Developer Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="export-mechanism"><a class="link" href="#export-mechanism">Export mechanism</a></h3>
<div class="paragraph">
<p>The export mechanism is facilitated by java <code>File</code> and <code>FileOutputStream</code> class. It supports writing contact information into a vCard format file.
This file will be saved in the application data folder where user can import it into other applications such as Google Contacts.</p>
</div>
<div class="paragraph">
<p>Firstly, a <code>Vcard</code> object has be to created for every person that user wants to export. <code>Vcard</code> of each person contains a unique
String <code>cardDetails</code> that stores information about the person. The current version of vCard used is 3.0 as shown in the code example below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>vCard format:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> Vcard(ReadOnlyPerson person) {
    requireNonNull(person);
    <span class="comment">//get all information from the person</span>
    cardDetails = <span class="string"><span class="delimiter">&quot;</span><span class="content">BEGIN:VCARD</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">VERSION:3.0</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">FN:</span><span class="delimiter">&quot;</span></span> + name + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">TEL;TYPE=MOBILE:</span><span class="delimiter">&quot;</span></span> + phone + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">EMAIL;TYPE=WORK:</span><span class="delimiter">&quot;</span></span> + email + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">BDAY:</span><span class="delimiter">&quot;</span></span> + birthday + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">ADR;TYPE=HOME:;;</span><span class="delimiter">&quot;</span></span> + address + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">END:VCARD</span><span class="delimiter">&quot;</span></span> + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, a <code>File</code> will be created. In order to store all the <code>cardDetails</code> created earlier, <code>FileOutputStream</code> will call its
method write to write and saved all information in the <code>File</code> named as "contacts.vcf". An example of how write method is execute is shown below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FileOutputStream write method:<br>
<code>cardDetails</code> are first encoded into a sequence of bytes and stored in a byte array, b.
<code>FileOutputStream</code> calls write(byte[] b) in order to write the encoded string into the file.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Creating an instance of FileOutputStream</span>
fos = <span class="keyword">new</span> <span class="predefined-type">FileOutputStream</span>(file);
<span class="comment">// For each Vcard created earlier</span>
    <span class="keyword">try</span> {
        <span class="comment">// FileOutputStream will write the string encoded as byte array into the file.</span>
        fos.write(vCard.getCardDetails().getBytes());
    } <span class="keyword">catch</span> (<span class="exception">IOException</span> e) {
        <span class="comment">// Print exception</span>
    }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, the directory for the "contacts.vcf" will be shown to the user and the file can be imported to other applications.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="enhancement-added-email"><a class="link" href="#enhancement-added-email">Enhancement Added: Email</a></h3>
<div class="sect3">
<h4 id="external-behavior-2"><a class="link" href="#external-behavior-2">External behavior</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: User Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sending-an-email-to-one-or-more-person-code-email-code"><a class="link" href="#sending-an-email-to-one-or-more-person-code-email-code">Sending an email to one or more person: <code>email</code></a></h3>
<div class="paragraph">
<p>Emails one or more person identified by the index number used in the last person listing.<br>
Format: <code>email INDEX [INDEX]&#8230;&#8203;</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Opens a default email application and compose a new email with the email address(es)
of all the person at the specified <code>INDEX</code>.</p>
</li>
<li>
<p>The index refers to the index number shown in the most recent listing</p>
</li>
<li>
<p>The index <strong>must be a positive integer</strong> 1, 2, 3, &#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>list</code><br>
<code>email 2 3</code><br>
Send an email to the 2nd person and 3rd person from the list of contacts listed.</p>
</li>
<li>
<p><code>find Betsy</code><br>
<code>email 1</code><br>
Send an email to the 1st person in the results of the <code>find</code> command.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
<div class="sect3">
<h4 id="implementation-2"><a class="link" href="#implementation-2">Implementation</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: Developer Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="email-mechanism"><a class="link" href="#email-mechanism">Email mechanism</a></h3>
<div class="paragraph">
<p>The email mechanism is facilitated by java <code>Desktop</code> class which allows java application to launch default mail client registered on the users' native desktop to handle a Uniform Resource Indentifier <code>URI</code>.
In this case, the <a href="#uri">URI</a> created is a reference to the mail command scheme and email addresses to mail to.</p>
</div>
<div class="sect3">
<h4 id="email-command-implementation"><a class="link" href="#email-command-implementation">Email command implementation</a></h4>
<div class="paragraph">
<p>image::3.2.1 Email Command Implementation.png[width="800"]</p>
</div>
<div class="paragraph">
<p><div align="center"><b>Figure 3.2.1 Email Command Implementation</b></div></p>
</div>
<div class="paragraph">
<p>From the diagram above, when users enter the command <code>email 1</code> to email a person in their address book.
<code>EmailCommandParser</code> will parse the arguments, which are either a single index or multiple indices, provided by the users and store them
in an array called <code>targetIndices</code> and return a <code>EmailCommand</code>. Next, <code>EmailCommand</code> will call its method <code>execute()</code>
and ensure that <code>Index</code> specified is valid and construct a String <code>allEmaillAddress</code> which contains all the email addresses. Refer to code example below:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code listing:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">        <span class="comment">// Do others in EmailCommand.execute()</span>
        <span class="comment">// StringBuilder helps to append the email addresses of each person</span>
        <span class="predefined-type">StringBuilder</span> addresses = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        <span class="keyword">for</span> (Index targetIndex : targetIndices) {
            <span class="comment">// Throws exception if target index is out of bounds</span>
        }
            addresses.append(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
            addresses.append(personToEmail.getEmail().toString());
        }
<span class="comment">// Add a comma between all email addresses</span>
<span class="predefined-type">String</span> allEmailAddresses = addresses.toString().trim().replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">,</span><span class="delimiter">&quot;</span></span>);
<span class="comment">// Return a CommandResult</span>
EventsCenter.getInstance().post(<span class="keyword">new</span> EmailRequestEvent(allEmailAddresses));
<span class="keyword">return</span> <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_EMAIL_PERSON_SUCCESS, allPersons));</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The String <code>allEmailAddresses</code> is constructed by appending a comma after each email address of a contact. This is done to ensure that it follows the syntax required when
constructing a <code>URI</code>.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="email-request-event-process"><a class="link" href="#email-request-event-process">Email request event process</a></h4>
<div class="paragraph">
<p>image::3.2.1 Email Request Event Process.png[width="800"]</p>
</div>
<div class="paragraph">
<p><div align="center"><b>Figure 3.2.2 Email Request Event Process</b></div></p>
</div>
<div class="paragraph">
<p>With reference to the diagram above, after <code>EmailCommand</code> has executed, it will post a new <code>EmailRequestEvent</code> and allow the UI to handle this event. In the UI, we are using java <code>Desktop</code> class to
launch the default mail client registered on users' native desktop. A <code>URI</code> instance have to be created and pass to the mail method in the <code>Desktop</code> class.
Refer to the code example below:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code listing:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> staic <span class="directive">final</span> <span class="predefined-type">String</span> EMAIL_URI_PREFIX = <span class="string"><span class="delimiter">&quot;</span><span class="content">mailTo:</span><span class="delimiter">&quot;</span></span>;

<span class="comment">// Do others in MainWindow</span>

<span class="predefined-type">URI</span> mailTo = <span class="keyword">new</span> <span class="predefined-type">URI</span>(EMAIL_URI_PREFIX + allEmailAddresses);
    <span class="comment">// Checks if Desktop class is supported</span>
    <span class="keyword">if</span> (Desktop.isDesktopSupported()) {
        Desktop userDesktop = Desktop.getDesktop();
        userDesktop.mail(mailTo);
    } <span class="keyword">else</span> {
        <span class="comment">// Throws Execepton</span>
    }</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To construct a valid <code>URI</code> instance, the scheme <code>EMAIL_URI_PREFIX</code> which specifies the operation to launch user&#8217;s default mail client must be
followed by the String <code>allEmailAddresses</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Lastly, users' desktop will launch a default mail client where they can compose the subject and message body of the email.
Moreover, users can also edit their recipients field to include carbon copy or blind carbon copy before sending out
the email to their recipients.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-consideration"><a class="link" href="#design-consideration">Design consideration</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Type of application to send emails<br>
<strong>Alternative 1 (current choice):</strong> Use user&#8217;s default mail client<br>
<strong>Pros:</strong> Default mail client tend to load faster than the default browser <code>WebView</code> used by <code>UI</code>: <code>BrowserPanel</code>.<br>
<strong>Cons:</strong> Does not support some operating systems such as Linux.<br>
<strong>Alternative 2:</strong> Use web browser to access user email services online.<br>
<strong>Pros:</strong> Able to support more users to use this email feature as there are more options for different users.<br>
<strong>Cons:</strong> Not all users use the same email services such as Gmail or Outlook. Moreover,
it is difficult to authorize every email services for all users since it is often dependent
on the type of email services they need.<br></p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="enhancement-proposed-to-be-updated"><a class="link" href="#enhancement-proposed-to-be-updated">Enhancement Proposed: to be updated</a></h3>

</div>
<div class="sect2">
<h3 id="other-contributions"><a class="link" href="#other-contributions">Other contributions</a></h3>
<div class="ulist">
<ul>
<li>
<p>Added Birthday field for a person</p>
</li>
<li>
<p>Modified search command to allow users to search for birthday</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-11-08 04:30:47 +00:00
</div>
</div>
</body>
</html>